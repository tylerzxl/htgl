{"version":3,"sources":["webpack:///./node_modules/@mdf/cube/src/bizmodel/mtlapi.js","webpack:///./node_modules/@mdf/cube/src/bizmodel/freeview.js"],"names":["_getParams","params","data","cParameter","JSON","parse","_showPrompt","result","platform","cb","utils","alert","console","log","mtlScan","billNo","viewmodel","beforeAct","afterAct","newParams","needResult","parseInt","scanType","Array","isArray","scanQRCode","success","res","resultStr","invoker","publish","action","fail","err","message","mtlShare","upesn","showShareMenu","mtlPlatform","mtlNetworkType","getNetworkType","networkType","mtlGetMac","getMac","macAddress","mtlDail","dail","mtlChooseImage","count","sourceType","chooseImage","localIds","mtlGetLocation","getLocation","mtlOpenLocation","openLocation","mtlGenerateQRCode","generateQRCode","mtlRequest","headers","e","request","mtlStartRecord","startRecord","mtlStopRecord","stopRecord","mtlPlayVoice","playVoice","mtlPauseVoice","pauseVoice","mtlStopVoice","stopVoice","mtlChangeScreenOrientation","changeScreenOrientation","mtlRestoreScreenOrientation","restoreScreenOrientation","mtlSetStorage","setStorage","mtlGetStorage","getStorage","mtlRemoveStorage","removeStorage","mtlClearStorage","clearStorage","mtlUploadFile","uploadFile","mtlDownloadFile","downloadFile","cellCheck","scan","share","freeview","gridModel","cellName","column","getColumn","location","rowIndex","key","childrenField","value","cControlType","toLowerCase","bCheck","init","callback","error","requireInner","vmurl","defaultParams","viewmeta","cBillNo","subId","cSubId","cardKey","cCardKey","vm","Function","viewmodels","vmName","setViewMeta","window","yya","extend","getParams","on","cBillName","initData","do","act","this","freeviewExtend","extendConfig","freeviewExtendConfig","freeviewAction","check","cellcheck","columnsetting","Object","assign","namespace","biz","common"],"mappings":"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","file":"public/javascripts/4.bundle.js?_=d566ad53-de75-49ba-965f-44adb4dd2a09","sourcesContent":["import mtl from 'mtl-js-sdk'\n\nfunction _getParams (params) {\n  let data = {};\n  if (params) {\n    if (params.cParameter) {\n      data = JSON.parse(params.cParameter);\n    } else {\n      data = params;\n    }\n  }\n  return data;\n}\n\nfunction _showPrompt (result) {\n  if (mtl.platform !== 'upesn') {\n    cb.utils.alert('当前平台： ' + mtl.platform + ' ，结果：' + result);\n  } else {\n    console.log('当前平台： ' + mtl.platform + ' ，结果：' + result);\n  }\n}\n\nexport function mtlScan (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = {};\n  if (params?.cParameter) {\n    const newParams = JSON.parse(params.cParameter);\n    data.needResult = newParams.needResult ? parseInt(newParams.needResult) : 1;\n    if (newParams.scanType === 'all') {\n      data.scanType = ['qrCode', 'barCode'];\n    } else {\n      if (!Array.isArray(data.scanType)) {\n        data.scanType = [newParams.scanType];\n      }\n    }\n  }\n  mtl.scanQRCode({\n    ...data,\n    success: function (res) {\n      const result = res.resultStr;\n      cb.invoker.publish('mtl', { action: 'scan', result: result });\n      _showPrompt(result);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n};\n\nexport function mtlShare (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.upesn.showShareMenu({\n    ...data,\n    success: function (res) {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'share', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n};\n\nexport function mtlPlatform (billNo, viewmodel, params, beforeAct, afterAct) {\n  const result = mtl.platform;\n  cb.invoker.publish('mtl', { action: 'platform', result: result });\n  _showPrompt(mtl.platform);\n};\n\nexport function mtlNetworkType (billNo, viewmodel, params, beforeAct, afterAct) {\n  mtl.getNetworkType({\n    success: function (res) {\n      const networkType = res.networkType;// 返回网络类型2g，3g，4g，wifi,无网状态下通过fail回调返回错误信息\n      cb.invoker.publish('mtl', { action: 'getNetworkType', networkType });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message;// 错误信息\n      _showPrompt(message);\n    }\n  });\n}\nexport function mtlGetMac (billNo, viewmodel, params, beforeAct, afterAct) {\n  mtl.getMac({\n    success: function (res) {\n      const macAddress = res.macAddress;\n      cb.invoker.publish('mtl', { action: 'getMac', result: macAddress });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message;// 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlDail (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.dail({\n    ...data,\n    success: function (res) {\n      cb.invoker.publish('mtl', { action: 'dail', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message;// 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlChooseImage (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = {};\n  if (params?.cParameter) {\n    const newParams = JSON.parse(params.cParameter);\n    data.count = newParams.count;\n    if (newParams.sourceType === 'all') {\n      data.sourceType = ['album', 'camera'];\n    } else {\n      if (!Array.isArray(data.sourceType)) {\n        data.sourceType = [newParams.sourceType];\n      }\n    }\n  }\n  mtl.chooseImage({\n    ...data,\n    success: function (res) {\n      // 返回选定照片的本地ID列表，localId可以作为img标签的src属性显示图片\n      const localIds = res.localIds; // ['wxLocalResource://imageid123456789987654321', ...]\n      cb.invoker.publish('mtl', { action: 'chooseImage', result: localIds });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlGetLocation (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.getLocation({\n    // type: 'wgs84',//默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'\n    ...data,\n    success: function (res) {\n      // var latitude = res.latitude;// 纬度，浮点数，范围为90~-90\n      // var longitude = res.longitude;// 经度，浮点数，范围为180~-180。\n      cb.invoker.publish('mtl', { action: 'getLocation', result: res });\n      _showPrompt(res);\n    },\n    fail (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlOpenLocation (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.openLocation({\n    // latitude: 40.07573,//纬度，浮点数，范围为90~-90\n    // longitude: 116.245412,//经度，浮点数，范围为180~-180。\n    // name: '',//位置名\n    // address: '',//地址详情说明\n    // scale: 1,//地图缩放级别,整形值,范围从1~28。默认为最大\n    ...data,\n    success: function (res) {\n      cb.invoker.publish('mtl', { action: 'openLocation', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlGenerateQRCode (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.generateQRCode({\n    // str: 'hello',//用于生成二维码的字符串\n    // size: 200,//生成图片大小，默认100*100\n    ...data,\n    success: function (res) {\n      // imgSrc为base64字符串\n      // var src = res.imgSrc;\n      cb.invoker.publish('mtl', { action: 'generateQRCode', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlRequest (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  if (data.headers && typeof data.headers === 'string') {\n    try {\n      data.headers = JSON.parse(data.headers);\n    } catch (e) {\n      alert('headers 参数错误')\n      return\n    }\n  }\n  if (data.params && typeof data.params === 'string') {\n    try {\n      data.params = JSON.parse(data.params);\n    } catch (e) {\n      alert('params 参数错误')\n      return\n    }\n  }\n  mtl.request({\n    // url: 'https://some-domain.com/api/user',\n    // method: 'get',\n    // headers: { 'X-Requested-With': 'XMLHttpRequest' },\n    // params: {\n    //   ID: 12345\n    // },\n    ...data,\n    success: function (res) {\n      const data = res.data; // 返回数据\n      cb.invoker.publish('mtl', { action: 'request', result: data });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  })\n}\n\nexport function mtlStartRecord (billNo, viewmodel, params, beforeAct, afterAct) {\n  mtl.startRecord({\n    success: function (res) {\n      cb.invoker.publish('mtl', { action: 'startRecord', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlStopRecord (billNo, viewmodel, params, beforeAct, afterAct) {\n  mtl.stopRecord({\n    success: function (res) {\n      // var localId = res.localId;// 微信音频的本地ID,用空间是BASE64加密处理后的音频数据字符串\n      cb.invoker.publish('mtl', { action: 'stopRecord', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlPlayVoice (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.playVoice({\n    // localId: '', // 需要播放的音频的本地ID，由stopRecord接口获得\n    ...data,\n    success: function (res) {\n      cb.invoker.publish('mtl', { action: 'playVoice', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlPauseVoice (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.pauseVoice({\n    // localId: '', // 需要暂停的音频的本地ID，由stopRecord接口获得\n    ...data,\n    success: function (res) {\n      cb.invoker.publish('mtl', { action: 'pauseVoice', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n\nexport function mtlStopVoice (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.stopVoice({\n    // localId: '', // 需要停止的音频的本地ID，由stopRecord接口获得\n    ...data,\n    success: function (res) {\n      cb.invoker.publish('mtl', { action: 'stopVoice', result: res });\n      _showPrompt(res);\n    },\n    fail: function (err) {\n      const message = err.message; // 错误信息\n      _showPrompt(message);\n    }\n  });\n}\n/**\n * 修改屏幕方向，横屏或者竖屏\n */\nexport function mtlChangeScreenOrientation (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.changeScreenOrientation({\n    // orientation: true,\n    ...data,\n    success: res => {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'changeScreenOrientation', result: res });\n      _showPrompt(res);\n    },\n    fail: err => {\n      const message = err.message;\n      _showPrompt(message);\n    }\n  })\n};\n\n/**\n * 恢复屏幕方向\n */\nexport function mtlRestoreScreenOrientation (billNo, viewmodel, params, beforeAct, afterAct) {\n  mtl.restoreScreenOrientation({\n    success: res => {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'restoreScreenOrientation', result: res });\n      _showPrompt(res);\n    },\n    fail: err => {\n      const message = err.message;\n      _showPrompt(message);\n    }\n  })\n};\n\n/**\n * 存储数据\n */\nexport function mtlSetStorage (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.setStorage({\n    // domain: '',\n    // key: '',\n    // data: {},\n    ...data,\n    success: res => {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'setStorage', result: res });\n      _showPrompt(res);\n    },\n    fail: err => {\n      const message = err.message;\n      _showPrompt(message);\n    }\n  })\n};\n\n/**\n * 读取数据\n */\nexport function mtlGetStorage (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.getStorage({\n    // domain: '',\n    // key: '',\n    ...data,\n    success: res => {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'getStorage', result: res });\n      _showPrompt(res);\n    },\n    fail: err => {\n      const message = err.message;\n      _showPrompt(message);\n    }\n  })\n};\n\n/**\n * 删除数据\n */\nexport function mtlRemoveStorage (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.removeStorage({\n    // domain: '',\n    // key: '',\n    ...data,\n    success: res => {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'removeStorage', result: res });\n      _showPrompt(res);\n    },\n    fail: err => {\n      const message = err.message;\n      _showPrompt(message);\n    }\n  })\n};\n\n/**\n * 清除所有数据\n */\nexport function mtlClearStorage (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.clearStorage({\n    // domain: '',\n    ...data,\n    success: res => {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'clearStorage', result: res });\n      _showPrompt(res);\n    },\n    fail: err => {\n      const message = err.message;\n      _showPrompt(message);\n    }\n  })\n};\n/**\n * 上传文件\n */\nexport function mtlUploadFile (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.uploadFile({\n    // url: '必填',\n    // filePath: '必填',\n    // header: { 'content-type': 'multipart/form-data' },\n    // formData: '',\n    ...data,\n    success: res => {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'uploadFile', result: res });\n      _showPrompt(res);\n    },\n    fail: err => {\n      const message = err.message;\n      _showPrompt(message);\n    }\n  })\n};\n/**\n * 下载文件\n */\nexport function mtlDownloadFile (billNo, viewmodel, params, beforeAct, afterAct) {\n  const data = _getParams(params);\n  mtl.downloadFile({\n    // url: '必填',\n    // fileType: '必填',\n    // header: '',\n    // formBody: '',\n    // jsonBody: '',\n    // autoPreview: '',\n    // fileName: '',\n    ...data,\n    success: res => {\n      // 成功回调\n      cb.invoker.publish('mtl', { action: 'downloadFile', result: res });\n      _showPrompt(res);\n    },\n    fail: err => {\n      const message = err.message;\n      _showPrompt(message);\n    }\n  })\n};\n","import * as common from './common';\nimport { mtlScan, mtlShare } from './mtlapi'\n\nconst freeview = (function () {\n  const cellCheck = function (billNo, viewmodel, params, beforeAct, afterAct) {\n    const gridModel = common.getGridModel(viewmodel, params);\n    const cellName = params.cellName;\n    const column = gridModel.getColumn(cellName);\n    const data = {\n      location: params.rowIndex,\n      key: cellName,\n      childrenField: params.childrenField,\n      value: params.value\n    }\n    const beforeActData = {\n      params: params,\n      data: data\n    };\n    if (!beforeAct(beforeActData)) return\n    if (column && column.cControlType.toLowerCase() == 'refer') {\n      // FIXME: refercheck函数不存在，可能有bug\n      common.refercheck(billNo, viewmodel, data, afterAct, true);\n    }\n    if (column.bCheck === true) {\n      common.check(billNo, viewmodel, data, afterAct, true);\n    }\n  };\n\n  const scan = (billNo, viewmodel, params, beforeAct, afterAct) => {\n    mtlScan(billNo, viewmodel, params, beforeAct, afterAct);\n  };\n  const share = function (billNo, viewmodel, params, beforeAct, afterAct) {\n    mtlShare(billNo, viewmodel, params, beforeAct, afterAct)\n  };\n\n  return {\n    init: function (billNo, params, callback) {\n      const initCallback = (err, result) => {\n        if (err) {\n          console.error(err);\n          return;\n        }\n        // let func = new Function(result.vm);\n        // func();\n        cb.requireInner(result.vmurl, function () {\n          const defaultParams = {\n            billNo: result.viewmeta.cBillNo,\n            subId: result.viewmeta.cSubId,\n            cardKey: result.viewmeta.cCardKey,\n          };\n          if (!result.vmurl && result.vm)\n            new Function(result.vm)();\n          const vm = new cb.viewmodels[result.viewmeta.vmName]();\n          vm.setViewMeta(result.viewmeta);\n          window.yya = vm\n          cb.utils.extend(true, vm.getParams(), defaultParams, params);\n          common.storeVmInstance(billNo, vm);\n          vm.on('extendReady', function () {\n            callback(vm, result.viewmeta, result.viewmeta.cBillName);\n          });\n          vm.initData();\n        })\n      }\n      common.fetchMeta(billNo, params, initCallback);\n    },\n    do: function (act, viewmodel, params) {\n      common.todo(this, act, viewmodel, params)\n    },\n    action: function () {\n      // 增加扩展机制，没有配置传入容错处理 yueming\n      let freeviewExtend = {}\n      try {\n        freeviewExtend = cb.extendConfig.freeviewExtendConfig;\n      } catch (error) {\n        console.log(error);\n        freeviewExtend = {};\n      }\n      const freeviewAction = {\n        scan: scan,\n        share: share,\n        check: common.check,\n        cellcheck: cellCheck,\n        columnsetting: common.columnsetting,\n      }\n      return Object.assign(freeviewAction, freeviewExtend);\n    }\n  }\n})()\n\ncb.namespace('biz.common');\ncb.biz.common.freeview = freeview;\n\nexport default freeview;\n"],"sourceRoot":""}